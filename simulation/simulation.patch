From bf725c98023ef3ccc40d4370369029801f693cd9 Mon Sep 17 00:00:00 2001
From: Kevin Laurent Biewesch <kevinbiewesch@yahoo.fr>
Date: Thu, 1 Jun 2023 11:09:16 +0200
Subject: [PATCH 1/5] add dockerfile

---
 Dockerfile | 22 ++++++++++++++++++++++
 1 file changed, 22 insertions(+)
 create mode 100644 Dockerfile

diff --git a/Dockerfile b/Dockerfile
new file mode 100644
index 0000000..a34f705
--- /dev/null
+++ b/Dockerfile
@@ -0,0 +1,22 @@
+ARG ROS_DISTRO=foxy
+FROM osrf/ros:${ROS_DISTRO}-desktop
+
+ENV ROS_WS=/root/ros2_ws
+ARG SIM_DIR="${ROS_WS}/src/mrs-mapping-simulation"
+
+# File is executed by ENTRYPOINT
+RUN sed --in-place \
+    's|^source .*|\0\nsource "${ROS_WS}/install/setup.bash"|' \
+    /ros_entrypoint.sh
+
+RUN apt update -y \
+    && apt install -y "ros-${ROS_DISTRO}-gazebo-ros" \
+    && rm -rf /var/lib/apt/lists/*
+
+WORKDIR ${ROS_WS}
+
+COPY . "${SIM_DIR}"
+
+RUN colcon build
+
+CMD ros2 launch mrs_mapping_simulation gazebo_scenario.launch.py
-- 
2.41.0


From 23c8272da1525bd6cdd09a152e6fb8568c0e75cc Mon Sep 17 00:00:00 2001
From: Kevin Laurent Biewesch <kevinbiewesch@yahoo.fr>
Date: Thu, 1 Jun 2023 11:09:29 +0200
Subject: [PATCH 2/5] remove broken dependency

---
 launch/gazebo_scenario.launch.py        |   1 -
 launch/multi_robot_spawn_rgbd.launch.py |   4 +-
 robot/box_bot_rgbd.urdf                 | 453 ------------------------
 robot/box_bot_rgbd.xacro                |  90 -----
 4 files changed, 1 insertion(+), 547 deletions(-)
 delete mode 100644 robot/box_bot_rgbd.urdf
 delete mode 100644 robot/box_bot_rgbd.xacro

diff --git a/launch/gazebo_scenario.launch.py b/launch/gazebo_scenario.launch.py
index 86164e9..66e0819 100644
--- a/launch/gazebo_scenario.launch.py
+++ b/launch/gazebo_scenario.launch.py
@@ -13,7 +13,6 @@ from launch.substitutions import LaunchConfiguration, FindExecutable
 from launch_ros.actions import Node
 
 def generate_launch_description():
-    pkg_box_bot_description = get_package_share_directory('box_bot_description')
     pkg_gazebo_ros = get_package_share_directory('gazebo_ros')
     pkg_mrs_mapping_simulation = get_package_share_directory('mrs_mapping_simulation')
 
diff --git a/launch/multi_robot_spawn_rgbd.launch.py b/launch/multi_robot_spawn_rgbd.launch.py
index a719ace..5479d51 100644
--- a/launch/multi_robot_spawn_rgbd.launch.py
+++ b/launch/multi_robot_spawn_rgbd.launch.py
@@ -47,8 +47,6 @@ def launch_setup(context, *args, **kwargs):
     number_of_robots = LaunchConfiguration('number_of_robots').perform(context)
 
 
-    pkg_box_bot_description = get_package_share_directory('box_bot_description')
-    
     #assert os.path.exists(urdf), "Thebox_bot.urdf doesnt exist in "+str(urdf)
     
     # Names and poses of the robots
@@ -152,4 +150,4 @@ def generate_launch_description():
         DeclareLaunchArgument('number_of_robots', default_value='2'),
         OpaqueFunction(function=launch_setup)
     ])
-    
\ No newline at end of file
+    
diff --git a/robot/box_bot_rgbd.urdf b/robot/box_bot_rgbd.urdf
deleted file mode 100644
index 28771f3..0000000
--- a/robot/box_bot_rgbd.urdf
+++ /dev/null
@@ -1,453 +0,0 @@
-<?xml version="1.0" ?>
-<!-- =================================================================================== -->
-<!-- |    This document was autogenerated by xacro from box_bot_rgbd.xacro             | -->
-<!-- |    EDITING THIS FILE BY HAND IS NOT RECOMMENDED  BUT AS BEEN DONE               | -->
-<!-- =================================================================================== -->
-<robot name="box_bot_rgbd">
-  <material name="black">
-    <color rgba="0.0 0.0 0.0 1.0"/>
-  </material>
-  <material name="blue">
-    <color rgba="0.203125 0.23828125 0.28515625 1.0"/>
-  </material>
-  <material name="green">
-    <color rgba="0.0 0.8 0.0 1.0"/>
-  </material>
-  <material name="grey">
-    <color rgba="0.2 0.2 0.2 1.0"/>
-  </material>
-  <material name="orange">
-    <color rgba="1.0 0.423529411765 0.0392156862745 1.0"/>
-  </material>
-  <material name="brown">
-    <color rgba="0.870588235294 0.811764705882 0.764705882353 1.0"/>
-  </material>
-  <material name="red">
-    <color rgba="0.80078125 0.12890625 0.1328125 1.0"/>
-  </material>
-  <material name="white">
-    <color rgba="1.0 1.0 1.0 1.0"/>
-  </material>
-  <gazebo reference="chassis">
-    <material>Gazebo/Blue</material>
-  </gazebo>
-  <gazebo reference="left_wheel">
-    <kp>1000.0</kp>
-    <kd>1000.0</kd>
-    <mu1>0.5</mu1>
-    <mu2>0.5</mu2>
-    <material>Gazebo/Blue</material>
-  </gazebo>
-  <gazebo reference="right_wheel">
-    <kp>1000.0</kp>
-    <kd>1000.0</kd>
-    <mu1>0.5</mu1>
-    <mu2>0.5</mu2>
-    <material>Gazebo/Blue</material>
-  </gazebo>
-  <!-- ros_control plugin -->
-  <gazebo>
-    <plugin filename="libgazebo_ros_control.so" name="gazebo_ros_control">
-      <robotNamespace>/box_bot</robotNamespace>
-      <robotParam>/robot_description</robotParam>
-      <robotSimType>gazebo_ros_control/DefaultRobotHWSim</robotSimType>
-    </plugin>
-  </gazebo>
-  <gazebo>
-    <plugin filename="libgazebo_ros_diff_drive.so" name="differential_drive_controller">
-
-      <ros>
-        <namespace>/box_bot</namespace>
-      </ros>
-
-      <!-- wheels -->
-      <left_joint>joint_right_wheel</left_joint>
-      <right_joint>joint_left_wheel</right_joint>
-
-      <!-- kinematics -->
-      <wheel_separation>0.1</wheel_separation>
-      <wheel_diameter>0.025</wheel_diameter>
-
-      <!-- limits -->
-      <max_wheel_torque>0.1</max_wheel_torque>
-      <max_wheel_acceleration>1.0</max_wheel_acceleration>
-
-      <!-- output -->
-      <publish_odom>true</publish_odom>
-      <publish_odom_tf>true</publish_odom_tf>
-
-      <odometry_frame>odom</odometry_frame>
-      <robot_base_frame>base_link</robot_base_frame>
-
-
-    </plugin>
-  </gazebo>
-  <!-- imu -->
-  <gazebo>
-    <plugin filename="libgazebo_ros_imu.so" name="gazebo_ros_imu_controller">
-      <robotNamespace>/box_bot/</robotNamespace>
-      <topicName>imu/data3</topicName>
-      <serviceName>imu/service</serviceName>
-      <bodyName>chassis</bodyName>
-      <gaussianNoise>0</gaussianNoise>
-      <rpyOffsets>0 0 0</rpyOffsets>
-      <updateRate>50.0</updateRate>
-      <alwaysOn>true</alwaysOn>
-      <gaussianNoise>0</gaussianNoise>
-    </plugin>
-  </gazebo>
-  <link name="base_link">
-      </link>
-  <link name="chassis">
-    <!-- pose and inertial -->
-    <pose>0 0 0 0 0 0</pose>
-    <inertial>
-      <mass value="1.0"/>
-      <origin rpy="0 0 0" xyz="0 0 -0.025"/>
-      <inertia ixx="0.00033333333333333343" ixy="0" ixz="0" iyy="0.00033333333333333343" iyz="0" izz="0.00033333333333333343"/>
-      <inertia ixx="0.000241935" ixy="0" ixz="0" iyy="0.000241935" iyz="0" izz="0.000241935"/>
-    </inertial>
-    <!-- body -->
-    <collision name="collision_chassis">
-      <geometry>
-        <box size="0.1 0.1 0.1"/>
-      </geometry>
-    </collision>
-    <visual name="visual_chassis">
-      <geometry>
-        <box size="0.1 0.1 0.1"/>
-      </geometry>
-    </visual>
-  </link>
-  <gazebo reference="chassis">
-    <material>Gazebo/Red</material>
-  </gazebo>
-  <joint name="base_link_joint" type="fixed">
-    <origin rpy="0 0 0" xyz="0 0 0"/>
-    <parent link="base_link"/>
-    <child link="chassis"/>
-  </joint>
-  <link name="right_wheel">
-    <inertial>
-      <mass value="0.2"/>
-      <origin rpy="0 1.5707 1.5707" xyz="0 0 0"/>
-      <inertia ixx="3.126666666666667e-05" ixy="0" ixz="0" iyy="3.126666666666667e-05" iyz="0" izz="6.250000000000001e-05"/>
-    </inertial>
-    <collision name="link_right_wheel_collision">
-      <origin rpy="0 1.5707 1.5707" xyz="0 0 0"/>
-      <geometry>
-        <cylinder length="0.001" radius="0.035"/>
-      </geometry>
-    </collision>
-    <visual name="link_right_wheel_visual">
-      <origin rpy="0 1.5707 1.5707" xyz="0 0 0"/>
-      <geometry>
-        <cylinder length="0.001" radius="0.035"/>
-      </geometry>
-    </visual>
-  </link>
-  <joint name="joint_right_wheel" type="continuous">
-    <origin rpy="0 0 0" xyz="0 0.05 -0.025"/>
-    <child link="right_wheel"/>
-    <parent link="chassis"/>
-    <axis rpy="0 0 0" xyz="0 1 0"/>
-    <limit effort="10000" velocity="1000"/>
-    <joint_properties damping="1.0" friction="1.0"/>
-  </joint>
-  <link name="left_wheel">
-    <inertial>
-      <mass value="0.2"/>
-      <origin rpy="0 1.5707 1.5707" xyz="0 0 0"/>
-      <inertia ixx="3.126666666666667e-05" ixy="0" ixz="0" iyy="3.126666666666667e-05" iyz="0" izz="6.250000000000001e-05"/>
-    </inertial>
-    <collision name="link_right_wheel_collision">
-      <origin rpy="0 1.5707 1.5707" xyz="0 0 0"/>
-      <geometry>
-        <cylinder length="0.001" radius="0.035"/>
-      </geometry>
-    </collision>
-    <visual name="link_right_wheel_visual">
-      <origin rpy="0 1.5707 1.5707" xyz="0 0 0"/>
-      <geometry>
-        <cylinder length="0.001" radius="0.035"/>
-      </geometry>
-    </visual>
-  </link>
-  <joint name="joint_left_wheel" type="continuous">
-    <origin rpy="0 0 0" xyz="0 -0.05 -0.025"/>
-    <child link="left_wheel"/>
-    <parent link="chassis"/>
-    <axis rpy="0 0 0" xyz="0 1 0"/>
-    <limit effort="10000" velocity="1000"/>
-    <joint_properties damping="1.0" friction="1.0"/>
-  </joint>
-  <!-- CASTER FRONT-->
-  <link name="front_yaw_link">
-    <inertial>
-      <mass value="0.001"/>
-      <origin rpy="0 1.5707 1.5707" xyz="0 0 0"/>
-      <inertia ixx="5.145833333333334e-09" ixy="0" ixz="0" iyy="5.145833333333334e-09" iyz="0" izz="1.0125000000000003e-08"/>
-    </inertial>
-    <collision name="link_right_wheel_collision">
-      <origin rpy="0 1.5707 1.5707" xyz="0 0 0"/>
-      <geometry>
-        <cylinder length="0.001" radius="0.0045000000000000005"/>
-      </geometry>
-    </collision>
-  </link>
-  <joint name="front_yaw_joint" type="continuous">
-    <origin rpy="0 0 0" xyz="0.04 0 -0.05"/>
-    <parent link="chassis"/>
-    <child link="front_yaw_link"/>
-    <axis xyz="0 0 1"/>
-    <limit effort="1000.0" velocity="100.0"/>
-    <dynamics damping="0.0" friction="0.1"/>
-  </joint>
-  <transmission name="front_yaw_joint_trans">
-    <type>transmission_interface/SimpleTransmission</type>
-    <joint name="front_yaw_joint">
-      <hardwareInterface>EffortJointInterface</hardwareInterface>
-    </joint>
-    <actuator name="front_yaw_jointMotor">
-      <hardwareInterface>EffortJointInterface</hardwareInterface>
-      <mechanicalReduction>1</mechanicalReduction>
-    </actuator>
-  </transmission>
-  <link name="front_roll_link">
-    <inertial>
-      <mass value="0.001"/>
-      <origin rpy="0 1.5707 1.5707" xyz="0 0 0"/>
-      <inertia ixx="5.145833333333334e-09" ixy="0" ixz="0" iyy="5.145833333333334e-09" iyz="0" izz="1.0125000000000003e-08"/>
-    </inertial>
-    <collision name="link_right_wheel_collision">
-      <origin rpy="0 1.5707 1.5707" xyz="0 0 0"/>
-      <geometry>
-        <cylinder length="0.001" radius="0.0045000000000000005"/>
-      </geometry>
-    </collision>
-  </link>
-  <joint name="front_roll_joint" type="continuous">
-    <origin rpy="0 0 0" xyz="0 0 0"/>
-    <parent link="front_yaw_link"/>
-    <child link="front_roll_link"/>
-    <axis xyz="1 0 0"/>
-    <limit effort="1000.0" velocity="100.0"/>
-    <dynamics damping="0.0" friction="0.1"/>
-  </joint>
-  <transmission name="front_roll_joint_trans">
-    <type>transmission_interface/SimpleTransmission</type>
-    <joint name="front_roll_joint">
-      <hardwareInterface>EffortJointInterface</hardwareInterface>
-    </joint>
-    <actuator name="front_roll_jointMotor">
-      <hardwareInterface>EffortJointInterface</hardwareInterface>
-      <mechanicalReduction>1</mechanicalReduction>
-    </actuator>
-  </transmission>
-  <link name="front_pitch_link">
-    <inertial>
-      <mass value="0.001"/>
-      <origin rpy="0 1.5707 1.5707" xyz="0 0 0"/>
-      <inertia ixx="4e-08" ixy="0" ixz="0" iyy="4e-08" iyz="0" izz="4e-08"/>
-    </inertial>
-    <collision name="front_collision">
-      <origin rpy="0 1.5707 1.5707" xyz="0 0 0"/>
-      <geometry>
-        <sphere radius="0.01"/>
-      </geometry>
-    </collision>
-    <visual name="front_visual">
-      <origin rpy="0 1.5707 1.5707" xyz="0 0 0"/>
-      <geometry>
-        <sphere radius="0.01"/>
-      </geometry>
-    </visual>
-  </link>
-  <joint name="front_pitch_joint" type="continuous">
-    <origin rpy="0 0 0" xyz="0 0 0"/>
-    <parent link="front_roll_link"/>
-    <child link="front_pitch_link"/>
-    <axis xyz="0 1 0"/>
-    <limit effort="1000.0" velocity="100.0"/>
-    <dynamics damping="0.0" friction="0.1"/>
-  </joint>
-  <transmission name="front_pitch_joint_trans">
-    <type>transmission_interface/SimpleTransmission</type>
-    <joint name="front_pitch_joint">
-      <hardwareInterface>EffortJointInterface</hardwareInterface>
-    </joint>
-    <actuator name="front_pitch_jointMotor">
-      <hardwareInterface>EffortJointInterface</hardwareInterface>
-      <mechanicalReduction>1</mechanicalReduction>
-    </actuator>
-  </transmission>
-  <gazebo reference="front_pitch_link">
-    <kp>1000000000000000000000000000.0</kp>
-    <kd>1000000000000000000000000000.0</kd>
-    <mu1>0.5</mu1>
-    <mu2>0.5</mu2>
-    <material>Gazebo/Green</material>
-  </gazebo>
-  <!-- CASTER FRONT-->
-  <link name="back_yaw_link">
-    <inertial>
-      <mass value="0.001"/>
-      <origin rpy="0 1.5707 1.5707" xyz="0 0 0"/>
-      <inertia ixx="5.145833333333334e-09" ixy="0" ixz="0" iyy="5.145833333333334e-09" iyz="0" izz="1.0125000000000003e-08"/>
-    </inertial>
-    <collision name="link_right_wheel_collision">
-      <origin rpy="0 1.5707 1.5707" xyz="0 0 0"/>
-      <geometry>
-        <cylinder length="0.001" radius="0.0045000000000000005"/>
-      </geometry>
-    </collision>
-  </link>
-  <joint name="back_yaw_joint" type="continuous">
-    <origin rpy="0 0 0" xyz="-0.04 0 -0.05"/>
-    <parent link="chassis"/>
-    <child link="back_yaw_link"/>
-    <axis xyz="0 0 1"/>
-    <limit effort="1000.0" velocity="100.0"/>
-    <dynamics damping="0.0" friction="0.1"/>
-  </joint>
-  <transmission name="back_yaw_joint_trans">
-    <type>transmission_interface/SimpleTransmission</type>
-    <joint name="back_yaw_joint">
-      <hardwareInterface>EffortJointInterface</hardwareInterface>
-    </joint>
-    <actuator name="back_yaw_jointMotor">
-      <hardwareInterface>EffortJointInterface</hardwareInterface>
-      <mechanicalReduction>1</mechanicalReduction>
-    </actuator>
-  </transmission>
-  <link name="back_roll_link">
-    <inertial>
-      <mass value="0.001"/>
-      <origin rpy="0 1.5707 1.5707" xyz="0 0 0"/>
-      <inertia ixx="5.145833333333334e-09" ixy="0" ixz="0" iyy="5.145833333333334e-09" iyz="0" izz="1.0125000000000003e-08"/>
-    </inertial>
-    <collision name="link_right_wheel_collision">
-      <origin rpy="0 1.5707 1.5707" xyz="0 0 0"/>
-      <geometry>
-        <cylinder length="0.001" radius="0.0045000000000000005"/>
-      </geometry>
-    </collision>
-  </link>
-  <joint name="back_roll_joint" type="continuous">
-    <origin rpy="0 0 0" xyz="0 0 0"/>
-    <parent link="back_yaw_link"/>
-    <child link="back_roll_link"/>
-    <axis xyz="1 0 0"/>
-    <limit effort="1000.0" velocity="100.0"/>
-    <dynamics damping="0.0" friction="0.1"/>
-  </joint>
-  <transmission name="back_roll_joint_trans">
-    <type>transmission_interface/SimpleTransmission</type>
-    <joint name="back_roll_joint">
-      <hardwareInterface>EffortJointInterface</hardwareInterface>
-    </joint>
-    <actuator name="back_roll_jointMotor">
-      <hardwareInterface>EffortJointInterface</hardwareInterface>
-      <mechanicalReduction>1</mechanicalReduction>
-    </actuator>
-  </transmission>
-  <link name="back_pitch_link">
-    <inertial>
-      <mass value="0.001"/>
-      <origin rpy="0 1.5707 1.5707" xyz="0 0 0"/>
-      <inertia ixx="4e-08" ixy="0" ixz="0" iyy="4e-08" iyz="0" izz="4e-08"/>
-    </inertial>
-    <collision name="back_collision">
-      <origin rpy="0 1.5707 1.5707" xyz="0 0 0"/>
-      <geometry>
-        <sphere radius="0.01"/>
-      </geometry>
-    </collision>
-    <visual name="back_visual">
-      <origin rpy="0 1.5707 1.5707" xyz="0 0 0"/>
-      <geometry>
-        <sphere radius="0.01"/>
-      </geometry>
-    </visual>
-  </link>
-  <joint name="back_pitch_joint" type="continuous">
-    <origin rpy="0 0 0" xyz="0 0 0"/>
-    <parent link="back_roll_link"/>
-    <child link="back_pitch_link"/>
-    <axis xyz="0 1 0"/>
-    <limit effort="1000.0" velocity="100.0"/>
-    <dynamics damping="0.0" friction="0.1"/>
-  </joint>
-  <transmission name="back_pitch_joint_trans">
-    <type>transmission_interface/SimpleTransmission</type>
-    <joint name="back_pitch_joint">
-      <hardwareInterface>EffortJointInterface</hardwareInterface>
-    </joint>
-    <actuator name="back_pitch_jointMotor">
-      <hardwareInterface>EffortJointInterface</hardwareInterface>
-      <mechanicalReduction>1</mechanicalReduction>
-    </actuator>
-  </transmission>
-  <gazebo reference="back_pitch_link">
-    <kp>1000000000000000000000000000.0</kp>
-    <kd>1000000000000000000000000000.0</kd>
-    <mu1>0.5</mu1>
-    <mu2>0.5</mu2>
-    <material>Gazebo/Green</material>
-  </gazebo>
-  <joint name="depth_camera_joint" type="fixed">
-    <origin rpy="0 0 0" xyz="0 0 0.05"/>
-    <parent link="chassis"/>
-    <child link="depth_camera_link"/>
-  </joint>
-  <link name="depth_camera_link">
-    <visual>
-      <origin rpy="0 0 0" xyz="0 0 0"/>
-      <geometry>
-        <box size="0.1 0.1 0.1"/>
-      </geometry>
-    </visual>
-    <collision>
-      <origin rpy="0 0 0" xyz="0 0 0"/>
-      <geometry>
-        <box size="0.1 0.1 0.1"/>
-      </geometry>
-    </collision>
-    <inertial>
-      <origin rpy="0 0 0" xyz="0 0 0"/>
-      <mass value="0.1"/>
-      <inertia ixx="0.0001" ixy="0" ixz="0" iyy="0.0001" iyz="0" izz="0.0001"/>
-    </inertial>
-  </link>
-  <gazebo reference="depth_camera_link">
-    <sensor name="rgb_cam" type="depth">
-      <camera>
-        <horizontal_fov>1.047</horizontal_fov>
-        <image>
-          <width>640</width>
-          <height>480</height>
-        </image>
-        <clip>
-          <near>0.01</near>
-          <far>10</far>
-        </clip>
-      </camera>
-      <plugin filename="libgazebo_ros_camera.so" name="depth_camera_controller">
-        <alwaysOn>true</alwaysOn>
-        <updateRate>30.0</updateRate>
-        <cameraName>depth_camera</cameraName>
-        <imageTopicName>/depth_camera/depth/image_raw</imageTopicName>
-        <cameraInfoTopicName>/depth_camera/depth/camera_info</cameraInfoTopicName>
-        <frameName>depth_camera_link</frameName>
-        <pointCloudTopicName>/depth_camera/depth/points</pointCloudTopicName>
-        <pointCloudCutoff>0.01</pointCloudCutoff>
-        <distortionK1>0</distortionK1>
-        <distortionK2>0</distortionK2>
-        <distortionK3>0</distortionK3>
-        <distortionT1>0</distortionT1>
-        <distortionT2>0</distortionT2>
-        <hackBaseline>0</hackBaseline>
-      </plugin>
-    </sensor>
-  </gazebo>
-</robot>
diff --git a/robot/box_bot_rgbd.xacro b/robot/box_bot_rgbd.xacro
deleted file mode 100644
index 9e0cc69..0000000
--- a/robot/box_bot_rgbd.xacro
+++ /dev/null
@@ -1,90 +0,0 @@
-<?xml version="1.0" ?>
-<robot name="box_bot_rgbd" xmlns:xacro="http://www.ros.org/wiki/xacro">
-
-  <xacro:include filename="$(find box_bot_description)/robot/materials.xacro" />
-  <xacro:include filename="$(find box_bot_description)/robot/properties.xacro" />
-  <xacro:include filename="$(find box_bot_description)/robot/macros.xacro" />
-  <xacro:include filename="$(find box_bot_description)/robot/wheels.xacro" />
-  <xacro:include filename="$(find box_bot_description)/robot/caster_wheels.xacro" />  
-  <xacro:include filename="$(find box_bot_description)/robot/box_bot_body.xacro" />
-  <xacro:include filename="$(find box_bot_description)/robot/box_bot.gazebo" />
-
-  <!-- Depth camera macro -->
-  <xacro:macro name="depth_camera" params="name parent *origin">
-    <joint name="${name}_joint" type="fixed">
-      <xacro:insert_block name="origin" />
-      <parent link="${parent}" />
-      <child link="${name}_link" />
-    </joint>
-    <link name="${name}_link">
-      <visual>
-        <origin xyz="0 0 0" rpy="0 0 0" />
-        <geometry>
-          <box size="0.1 0.1 0.1" />
-        </geometry>
-      </visual>
-      <collision>
-        <origin xyz="0 0 0" rpy="0 0 0" />
-        <geometry>
-          <box size="0.1 0.1 0.1" />
-        </geometry>
-      </collision>
-      <inertial>
-        <origin xyz="0 0 0" rpy="0 0 0" />
-        <mass value="0.1" />
-        <inertia ixx="0.0001" ixy="0" ixz="0" iyy="0.0001" iyz="0" izz="0.0001" />
-      </inertial>
-    </link>
-    <gazebo reference="${name}_link">
-      <sensor type="depth" name="${name}_sensor">
-        <camera>
-          <horizontal_fov>1.047</horizontal_fov>
-          <image>
-            <width>640</width>
-            <height>480</height>
-          </image>
-          <clip>
-            <near>0.01</near>
-            <far>10</far>
-          </clip>
-        </camera>
-        <plugin name="${name}_controller" filename="libgazebo_ros_camera.so">
-          <alwaysOn>true</alwaysOn>
-          <updateRate>30.0</updateRate>
-          <cameraName>${name}</cameraName>
-          <imageTopicName>/${name}/depth/image_raw</imageTopicName>
-          <cameraInfoTopicName>/${name}/depth/camera_info</cameraInfoTopicName>
-          <frameName>${name}_link</frameName>
-          <pointCloudTopicName>/${name}/depth/points</pointCloudTopicName>
-          <pointCloudCutoff>0.01</pointCloudCutoff>
-          <distortionK1>0</distortionK1>
-          <distortionK2>0</distortionK2>
-          <distortionK3>0</distortionK3>
-          <distortionT1>0</distortionT1>
-          <distortionT2>0</distortionT2>
-          <hackBaseline>0</hackBaseline>
-        </plugin>
-      </sensor>
-    </gazebo>
-  </xacro:macro>
-          
-  
-  <xacro:box_bot_body parent_name="${base_name}"/>
-
-  
-  <xacro:link_wheel name="right_wheel" r="${wheel_radius}" l="${wheel_width}" incr="${wheel_increment}"/>
-  <xacro:joint_wheel name="joint_right_wheel" parent="${base_name}" child="right_wheel" origin_xyz="0 ${base_box_x / 2.0} ${-1.0 * wheel_radius}" />
-
-  <xacro:link_wheel name="left_wheel" r="${wheel_radius}" l="${wheel_width}" incr="${wheel_increment}"/>
-  <xacro:joint_wheel name="joint_left_wheel" parent="${base_name}" child="left_wheel" origin_xyz="0 ${-1.0 * base_box_x / 2.0} ${-1.0 * wheel_radius}" />
-
-
-  <xacro:caster_wheel parent="chassis" caster_wheel_name="front" origin_xyz="${(base_box_x / 2.0) - wheel_increment} 0 ${-1.0* base_box_x / 2.0}" radius="${wheel_increment}" legth="${dummy_length}"/>
-  <xacro:caster_wheel parent="chassis" caster_wheel_name="back" origin_xyz="${(-1.0 *base_box_x / 2.0) + wheel_increment} 0 ${-1.0* base_box_x / 2.0}" radius="${wheel_increment}" legth="${dummy_length}"/>
-  
-        <!-- Add depth camera to the robot -->
-  <xacro:depth_camera name="depth_camera" parent="${base_name}">
-  <origin xyz="0 0 ${base_box_x / 2.0}" rpy="0 0 0" />
-  </xacro:depth_camera>
-          
-</robot>
-- 
2.41.0


From 6629871275983121c8386f5f02f56a3359605c1b Mon Sep 17 00:00:00 2001
From: Kevin Laurent Biewesch <kevinbiewesch@yahoo.fr>
Date: Thu, 1 Jun 2023 11:37:16 +0200
Subject: [PATCH 3/5] install missing dependencies

---
 Dockerfile | 7 ++++---
 1 file changed, 4 insertions(+), 3 deletions(-)

diff --git a/Dockerfile b/Dockerfile
index a34f705..ba62192 100644
--- a/Dockerfile
+++ b/Dockerfile
@@ -9,9 +9,10 @@ RUN sed --in-place \
     's|^source .*|\0\nsource "${ROS_WS}/install/setup.bash"|' \
     /ros_entrypoint.sh
 
-RUN apt update -y \
-    && apt install -y "ros-${ROS_DISTRO}-gazebo-ros" \
-    && rm -rf /var/lib/apt/lists/*
+RUN apt update -y && apt install -y \
+    "ros-${ROS_DISTRO}-gazebo-ros" \
+    "ros-${ROS_DISTRO}-turtlebot3*"
+RUN rm -rf /var/lib/apt/lists/*
 
 WORKDIR ${ROS_WS}
 
-- 
2.41.0


From 8389077068d27f430fb4ae4176c1fd4df868ee87 Mon Sep 17 00:00:00 2001
From: Kevin Laurent Biewesch <kevinbiewesch@yahoo.fr>
Date: Thu, 8 Jun 2023 10:40:31 +0200
Subject: [PATCH 4/5] also source entrypoint in bashrc

---
 Dockerfile | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/Dockerfile b/Dockerfile
index ba62192..05a731e 100644
--- a/Dockerfile
+++ b/Dockerfile
@@ -7,7 +7,8 @@ ARG SIM_DIR="${ROS_WS}/src/mrs-mapping-simulation"
 # File is executed by ENTRYPOINT
 RUN sed --in-place \
     's|^source .*|\0\nsource "${ROS_WS}/install/setup.bash"|' \
-    /ros_entrypoint.sh
+    /ros_entrypoint.sh \
+    && echo "source /ros_entrypoint.sh" >> /root/.bashrc
 
 RUN apt update -y && apt install -y \
     "ros-${ROS_DISTRO}-gazebo-ros" \
-- 
2.41.0


From ce2a9d2168f655c4a45a9fadb9904ba07ff39215 Mon Sep 17 00:00:00 2001
From: Kevin Laurent Biewesch <kevinbiewesch@yahoo.fr>
Date: Thu, 8 Jun 2023 10:40:41 +0200
Subject: [PATCH 5/5] add launch options to ros2 command

---
 Dockerfile | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/Dockerfile b/Dockerfile
index 05a731e..90212a1 100644
--- a/Dockerfile
+++ b/Dockerfile
@@ -21,4 +21,4 @@ COPY . "${SIM_DIR}"
 
 RUN colcon build
 
-CMD ros2 launch mrs_mapping_simulation gazebo_scenario.launch.py
+CMD ros2 launch mrs_mapping_simulation gazebo_scenario.launch.py "world:=${ROS_WS}/src/mrs-mapping-simulation/worlds/moon.world" "number_of_robots:=3"
-- 
2.41.0

